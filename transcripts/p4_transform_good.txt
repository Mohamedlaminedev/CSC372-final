Model: gpt-4o-mini (ChatGPT web, default settings)
Timestamp: 2025-12-08T11:39:02-07:00

Prompt:
You are helping me complete a CSC 372 verification assignment. I will give you a C function stub that already contains an ACSL contract. Please fill in ONLY the function body so that the implementation is straightforward C code adhering to standard Frama-C/WP practices.

Requirements:
1. Do not remove or edit the ACSL comment block.
2. Keep the implementation iterative (no recursion) and use simple loops/conditionals as needed.
3. Add loop invariants/variants if the verification tool would reasonably require them.
4. Do not introduce extra helper functions or headers; stay within the stub provided.
5. Follow the intent of the spec precisely; no undefined behavior.

Return ONLY the completed function definition. Assume #include <stddef.h> is already present.

```
#include <stddef.h>

/*@
  requires n >= 0;
  requires \valid(a + (0 .. n-1));
  assigns a[0 .. n-1];
  ensures \forall integer k; 0 <= k < n ==> ((\old(a[k]) <= 0 ==> a[k] == 0) && (\old(a[k]) > 0 ==> a[k] == k));
*/
void p4_transform(int *a, int n) {
  // TODO
}
```

Response:
```
void p4_transform(int *a, int n) {
  int k = 0;
  /*@ loop invariant 0 <= k <= n;
      loop invariant \forall integer i; 0 <= i < k ==>
        ((\at(a[i], Pre) <= 0 ==> a[i] == 0) &&
         (\at(a[i], Pre) > 0 ==> a[i] == i));
      loop invariant \forall integer i; k <= i < n ==> a[i] == \at(a[i], Pre);
      loop assigns k, a[0 .. n - 1];
      loop variant n - k;
  */
  while (k < n) {
    int original = a[k];
    if (original <= 0) {
      a[k] = 0;
    } else {
      a[k] = k;
    }
    k++;
  }
}
```
